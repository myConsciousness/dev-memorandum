# JUnit5 のパラメータ化テストについて

## 概要

先日 `JUnit5` でテストコードを書く際にパラメータ化テストの存在を知ったので、実装しながら学習した内容を整理しておく。

パラメータ化テストはパラメータを変更して複数のテストパターンを作成する際に非常に便利で有用なので、この際に使い方を基礎から習得しておきたい。

## パラメータ化テストとは

`パラメータ化テスト` とは、入力データだけが異なる複数のテストケースを作成する際に定義してテストコードを作成する際の生産性を向上させるテスト方式である。実際には、`JUnitフレームワーク` を使用して実装する。

`パラメータ化テスト` は `JUnit4` からある機能のようで、`JUnit5` では `JUnit4` での欠点や冗長性を改善した諸機能がフレームワークとして提供されている。

## パラメータ化テストの実装

### 1. 依存関係の追加

`JUnit5` で `パラメータ化テスト` を行うためにもまず以下の依存関係を追加する。

> **_Note:_**</br>
> 実際にパラメータ化テストを実装する際に必要な機能は `junit-jupiter-params` パッケージにある。
> `junit-jupiter` には `JUnit5` を起動する際に必要な機能やパッケージがバンドルされている。

**_Maven_**

```xml
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter</artifactId>
    <version>5.5.2</version>
    <scope>test</scope>
</dependency>
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter-params</artifactId>
    <version>5.5.2</version>
    <scope>test</scope>
</dependency>
```

**_Gradle_**

```groovy
dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter:5.5.2'
    testImplementation 'org.junit.jupiter:junit-jupiter-params:5.5.2'
}
```

### 2. 必須アノテーションをインポート

`パラメータ化テスト` を実装するのに必須となる `ParametarizedTest` アノテーションを `org.junit.jupiter.params` パッケージからインポートする。

```java
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;
```

> **_Note:_**</br>
> 実際に入力パラメータを定義するアノテーションには　`ValueSource` アノテーションと `MethodSource` アノテーションがあるが、実装例としては `ValueSource` アノテーションを使用する。

### 3. パラメータ化されたテストメソッドを実装

`パラメータ化テスト` として定義するテストメソッドには `@ParameterizedTest` アノテーションを定義し、入力パラメータを `@ValueSource` アノテーションに定義する。

より複雑な入力パターンを実施する場合は入力データを生成するメソッドを定義し、そのメソッドを `@MethodSource` アノテーションに定義する。この方法に関しては後述する。

`@ParameterizedTest` アノテーションと `@ValueSource` アノテーションを使用して `String` の入力パラメータを定義する場合は以下のようになる。

```java
import org.junit.jupiter.params.ParameterizedTest;
import org.junit.jupiter.params.provider.ValueSource;

class Test {

    @ParameterizedTest
    @ValueSource(strings = {"test1", "test2", "test3"})
    void testSomething(String testParameter) {
        // test something
    }
}
```

上記の例だと、`@ValueSource` アノテーションに定義された入力パラメータが順次にテストメソッドに与えられる。つまり、上記の `testSomething` メソッドは `@ValueSource` アノテーションに定義された入力パラメータ分だけテスト処理が行われる。
